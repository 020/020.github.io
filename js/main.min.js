$(document).ready(function(){$(".header").height($(window).height())}),$(document).ready(function(){$(window).scroll(function(){$(this).scrollTop()>50?$("#back-to-top").fadeIn():$("#back-to-top").fadeOut()}),$("#back-to-top").click(function(){return $("body,html").animate({scrollTop:0},400),!1})});var default_defn={icon:"fa-book"},ckan_url="https://catalogue.data.wa.gov.au",theme_defns={"Business Support and Regulation":{icon:"fa-book"},"Cultural Affairs":{icon:"fa-paint-brush"},Defence:{icon:"fa-fighter-jet"},Environment:{icon:"fa-leaf"},"Finance Management":{icon:"fa-dollar-sign"},Immigration:{icon:"fa-plane"},"Maritime Services":{icon:"fa-anchor"},Security:{icon:"fa-shield-alt"},Trade:{icon:"fa-ship"},"Civic Infrastructure":{icon:"fa-road"},"Indigenous Affairs":{icon:"fa-bullseye"},"Natural Resources":{icon:"fa-gem"},"Sport and Recreation":{icon:"fa-futbol"},Transport:{icon:"fa-train"},Communications:{icon:"fas fa-phone-alt"},"Education and Training":{icon:"fa-graduation-cap"},Governance:{icon:"fa-university"},"International Relations":{icon:"fa-globe"},"Primary Industries":{icon:"fa-industry"},"Statistical Services":{icon:"fa-chart-bar"},"Community Services":{icon:"fa-wheelchair"},Employment:{icon:"fa-users"},"Health Care":{icon:"fas fa-plus-square"},"Justice Administration":{icon:"fa-balance-scale"},Science:{icon:"fa-flask"},Tourism:{icon:"fa-suitcase"}};function get_package_counts_by_facet(e){return $.ajax({url:ckan_url+"/api/3/action/package_search",data:{"facet.field":'["'+e+'"]',rows:0},type:"GET",dataType:"json"})}$.when(get_package_counts_by_facet("theme"),get_package_counts_by_facet("geospatial_theme")).done(function(e,t){var a=[];!0===Array.isArray(e)&&void 0!==e[0]&&!0===e[0].success&&(a=Object.assign(a,e[0].result.facets.theme));var n=$("div.container.categories_actual > div.row").first();Object.keys(a).sort().forEach(function(e){var t=a[e],o=e in theme_defns?theme_defns[e]:default_defn,r=ckan_url+"/dataset?theme="+e,s=$("<p>",{class:"category_item"}).append($("<i>",{class:"fas fa-fw mr-2 "+o.icon})).append($("<a>",{href:r}).text(e)).append($("<strong>").text(" ("+t+") "));n.append(s)})});var top_search=new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){function a(e){return $.ajax({url:ckan_url+"/api/3/action/"+e,type:"GET",dataType:"json"})}e=e.toLowerCase(),$.when(a("tag_list"),a("package_list")).done(function(a,n){var o=[];if(!0===Array.isArray(a)&&void 0!==a[0]&&!0===a[0].success&&(o=Object.assign(o,a[0].result)),1==n[0].success){o=(o=Object.assign(o,n[0].result)).map(function(e){return e.toLowerCase()});for(var r=0;r<o.length;r++)o[r]=o[r].replace(/-/g," ").replace(/_/g," ");var s=[];for(r=0;r<o.length;r++)~o[r].toLowerCase().indexOf(e)&&s.push(o[r]);s=s.filter((e,t,a)=>a.indexOf(e)==t),t(s)}})}}),main_search=new autoComplete({selector:"#main_search",minChars:3,source:function(e,t){function a(e){return $.ajax({url:ckan_url+"/api/3/action/"+e,type:"GET",dataType:"json"})}e=e.toLowerCase(),$.when(a("tag_list"),a("package_list")).done(function(a,n){var o=[];if(!0===Array.isArray(a)&&void 0!==a[0]&&!0===a[0].success&&(o=Object.assign(o,a[0].result)),1==n[0].success){o=(o=Object.assign(o,n[0].result)).map(function(e){return e.toLowerCase()});for(var r=0;r<o.length;r++)o[r]=o[r].replace(/-/g," ").replace(/_/g," ");var s=[];for(r=0;r<o.length;r++)~o[r].toLowerCase().indexOf(e)&&s.push(o[r]);s=s.filter((e,t,a)=>a.indexOf(e)==t),t(s)}})}}),zen_search=new autoComplete({selector:"#zen_search",minChars:3,source:function(e,t){e=e.toLowerCase(),function e(t,a="https://toolkit.data.wa.gov.au/api/v2/help_center/en-gb/articles.json",n=[]){return new Promise((o,r)=>fetch(a).then(a=>{if(200!==a.status)throw`${a.status}: ${a.statusText}`;a.json().then(a=>{n=n.concat(a.articles),a.next_page?(t&&t(n),e(t,a.next_page,n).then(o).catch(r)):o(n)}).catch(r)}).catch(r))}(function(e){}).then(a=>{for(var n=[],o=0;o<a.length;o++){n.push(a[o].title);for(var r=0;r<a[o].label_names.length;r++)n.push(a[o].label_names[r])}var s=n.filter(function(e,t,a){return t===a.indexOf(e)}),c=[];for(o=0;o<s.length;o++)~s[o].toLowerCase().indexOf(e)&&c.push(s[o]);t(c)}).catch(console.error)}});function searchType(){var e=document.top_search_input;switch(document.getElementById("top_search").setAttribute("name","q"),document.top_search_input.search_type.selectedIndex,e.search_type.selectedIndex){case 0:e.action="https://catalogue.data.wa.gov.au/dataset",top_search.destroy();new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){function a(e){return $.ajax({url:ckan_url+"/api/3/action/"+e,type:"GET",dataType:"json"})}e=e.toLowerCase(),$.when(a("tag_list"),a("package_list")).done(function(a,n){var o=[];if(!0===Array.isArray(a)&&void 0!==a[0]&&!0===a[0].success&&(o=Object.assign(o,a[0].result)),1==n[0].success){o=(o=Object.assign(o,n[0].result)).map(function(e){return e.toLowerCase()});for(var r=0;r<o.length;r++)o[r]=o[r].replace(/-/g," ").replace(/_/g," ");var s=[];for(r=0;r<o.length;r++)~o[r].toLowerCase().indexOf(e)&&s.push(o[r]);s=s.filter((e,t,a)=>a.indexOf(e)==t),t(s)}})}});break;case 1:e.action="https://catalogue.data.wa.gov.au/organization",top_search.destroy();new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){e=e.toLowerCase(),$.ajax({url:ckan_url+"/api/3/action/organization_list",type:"get",dataType:"json",complete:function(a){if(!0===a.responseJSON.success){for(var n=[],o=0;o<a.responseJSON.result.length;o++)n.push(a.responseJSON.result[o]);for(o=0;o<n.length;o++)n[o]=n[o].replace(/-/g," ").replace(/_/g," ");var r=[];for(o=0;o<n.length;o++)~n[o].toLowerCase().indexOf(e)&&r.push(n[o]);t(r)}}})}});break;case 2:e.action="https://catalogue.data.wa.gov.au/group",top_search.destroy();new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){e=e.toLowerCase(),$.ajax({url:ckan_url+"/api/3/action/group_list",type:"get",dataType:"json",complete:function(a){if(!0===a.responseJSON.success){for(var n=[],o=0;o<a.responseJSON.result.length;o++)n.push(a.responseJSON.result[o]);for(o=0;o<n.length;o++)n[o]=n[o].replace(/-/g," ").replace(/_/g," ");var r=[];for(o=0;o<n.length;o++)~n[o].toLowerCase().indexOf(e)&&r.push(n[o]);t(r)}}})}});break;case 3:e.action="https://catalogue.data.wa.gov.au/showcase",top_search.destroy();new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){e=e.toLowerCase(),$.ajax({url:ckan_url+"/api/3/action/ckanext_showcase_list",type:"get",dataType:"json",complete:function(a){if(!0===a.responseJSON.success){for(var n=[],o=0;o<a.responseJSON.result.length;o++){n.push(a.responseJSON.result[o].title);for(var r=0;r<a.responseJSON.result[o].tags.length;r++)n.push(a.responseJSON.result[o].tags[r].name)}var s=(n=n.map(function(e){return e.toLowerCase()})).filter(function(e,t,a){return t===a.indexOf(e)}),c=[];for(o=0;o<s.length;o++)~s[o].toLowerCase().indexOf(e)&&c.push(s[o]);t(c)}}})}});break;case 4:document.getElementById("top_search").setAttribute("name","query"),e.action="https://toolkit.data.wa.gov.au/hc/en-gb/search?utf8=%E2%9C%93&",top_search.destroy();new autoComplete({selector:"#top_search",minChars:3,source:function(e,t){e=e.toLowerCase(),function e(t,a="https://toolkit.data.wa.gov.au/api/v2/help_center/en-gb/articles.json",n=[]){return new Promise((o,r)=>fetch(a).then(a=>{if(200!==a.status)throw`${a.status}: ${a.statusText}`;a.json().then(a=>{n=n.concat(a.articles),a.next_page?(t&&t(n),e(t,a.next_page,n).then(o).catch(r)):o(n)}).catch(r)}).catch(r))}(function(e){}).then(a=>{for(var n=[],o=0;o<a.length;o++){n.push(a[o].title);for(var r=0;r<a[o].label_names.length;r++)n.push(a[o].label_names[r])}var s=n.filter(function(e,t,a){return t===a.indexOf(e)}),c=[];for(o=0;o<s.length;o++)~s[o].toLowerCase().indexOf(e)&&c.push(s[o]);t(c)}).catch(console.error)}})}}var dteNow=new Date,intYear=dteNow.getFullYear();$("#copyright").each(function(){var e=$(this).text();$(this).text(e.replace("CurrentCopyrightYear",intYear))});